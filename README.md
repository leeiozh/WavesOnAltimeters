# WavesOnAltimeters

В репозитории размещены наработанные скрипты по

- обработке данных альтиметрии (TrackProcess)
- прогнозированию пролетов альтиметров (FlyForecast)

## Установка

Ничего сверхъестественного.

```sh
git clone https://github.com/leeiozh/WavesOnAltimeters.git
cd WavesOnAltimeters
conda create -y --name alti_env python=3.10
conda install --force-reinstall -y -q --name alti_env -c conda-forge --file requirements.txt
conda activate alti_env
```

Альтернативная установка пакетов.

```sh
pip install -r requirements.txt
```

## Использование

### FlyForecast

Если вы собираетесь использовать прогнозера пролетов, **обязательно** регулярно обновляйте данные об орбите спутников.

```sh
cd FlyForecast
python update_tle.py
```

Для прогноза необходимо задать координаты и время. Для долгосрочного прогноза рекомендую построить route в OpenCPN и
загрузить его в папку FlyForecast/track в формате .kml. После этого в соответствующих переменных указываем время первой
точки маршрута и предполагаемую скорость в узлах.

```python
TRACK_FILE = "track/your_track.kml"
KML_OR_TXT = (TRACK_FILE[-3:] == 'kml')  # флаг, юзать данные из KML (долгосрочный прогноз) или TXT (на пару дней)
SPEED = 7.5  # предполагаемая скорость в узлах
START_TIME = dt.datetime(2023, 12, 1, 0, 0, 0, tzinfo=dt.timezone.utc)  # время старта расчета
END_TIME = 1  # количество суток краткосрочного расчета (не советую ставить больше 2)
MAX_DISTANCE = 220  # максимальное расстояние по поверхности между треком судна и спутника в километрах
```

Для прогноза на один-два дня можно отказаться от таких сложностей: вбить руками в файл формата .txt предполагаемые
координаты (проверьте минусы!)

```
градус_широты минута_широты градус_долготы минута_долготы
```

Помимо этого для хорошей отрисовки необходимо выставить параметры границ карты и шага сетки. Советую отрисовывать карту,
чтобы глазами отслеживать адекватность результатов.

После запуска forecast.py выведет информацию о времени (ПО UTC) и координатах пролета спутника текстом в консоль и в
файл schedule.xlsx.

### TrackProcess

Если вы собираетесь обрабатывать данные рейсов, необходимо выкачать данные с альтиметров на нужные даты. Например, для
АИ63 они размещены по адресу https://disk.yandex.ru/d/zS_iJN8qjlr2bA. Вырезки на АИ57, АИ58 и АСВ50 могу предоставить по
отдельному запросу.

Путь к подобной папке необходимо указывать внутри переменной

```python
sat_data = read_sat_data('/your_path/AI63_SatelliteData/', sat_names)
```

В свою очередь данные о положении и времени измерений необходимо задавать по образу и подобию файлов из папки
TrackProcess/track

Ниже указаны важные изменяемые параметры учета данных

```python
WIN_TIME = 7200  # окно по времени в секундах
WIN_ANGLE = 2.5  # окно по координате в градусах
```

После запуска comp_*.py выведет информацию о нашем измерении, расстоянии до ближайшей точки трека спутника (километры и
минуты) и измеренную им SWH (пока просто в консоль).